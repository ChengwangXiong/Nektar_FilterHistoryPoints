<?xml version="1.0" encoding="utf-8" ?>
<NEKTAR>
    <GEOMETRY DIM="2" SPACE="2">
        <VERTEX>
            <V ID="2">-1.000e-02 -1.000e-02 0.000e+00</V>
            <V ID="3">1.000e-02 -1.000e-02 0.000e+00</V>
            <V ID="0">1.000e-02 1.000e-02 0.000e+00</V>
            <V ID="1">-1.000e-02 1.000e-02 0.000e+00</V>
            <V ID="83">-1.000e+00 -1.000e-02 0.000e+00</V>
            <V ID="28">1.000e+00 -1.000e-02 0.000e+00</V>
            <V ID="35">1.000e+00 1.000e-02 0.000e+00</V>
            <V ID="76">-1.000e+00 1.000e-02 0.000e+00</V>
            <V ID="10">-1.000e-02 -1.000e+00 0.000e+00</V>
            <V ID="11">1.000e-02 -1.000e+00 0.000e+00</V>
            <V ID="43">1.000e-02 1.000e+00 0.000e+00</V>
            <V ID="59">-1.000e-02 1.000e+00 0.000e+00</V>
            <V ID="97">-1.000e+00 -1.000e+00 0.000e+00</V>
            <V ID="31">1.000e+00 -1.000e+00 0.000e+00</V>
            <V ID="55">1.000e+00 1.000e+00 0.000e+00</V>
            <V ID="79">-1.000e+00 1.000e+00 0.000e+00</V>
            <V ID="37">1.000e-02 2.575e-01 0.000e+00</V>
            <V ID="39">1.000e-02 5.050e-01 0.000e+00</V>
            <V ID="41">1.000e-02 7.525e-01 0.000e+00</V>
            <V ID="32">2.575e-01 1.000e-02 0.000e+00</V>
            <V ID="33">5.050e-01 1.000e-02 0.000e+00</V>
            <V ID="34">7.525e-01 1.000e-02 0.000e+00</V>
            <V ID="13">2.575e-01 -1.000e-02 0.000e+00</V>
            <V ID="18">5.050e-01 -1.000e-02 0.000e+00</V>
            <V ID="23">7.525e-01 -1.000e-02 0.000e+00</V>
            <V ID="5">1.000e-02 -2.575e-01 0.000e+00</V>
            <V ID="7">1.000e-02 -5.050e-01 0.000e+00</V>
            <V ID="9">1.000e-02 -7.525e-01 0.000e+00</V>
            <V ID="4">-1.000e-02 -2.575e-01 0.000e+00</V>
            <V ID="6">-1.000e-02 -5.050e-01 0.000e+00</V>
            <V ID="8">-1.000e-02 -7.525e-01 0.000e+00</V>
            <V ID="80">-2.575e-01 -1.000e-02 0.000e+00</V>
            <V ID="81">-5.050e-01 -1.000e-02 0.000e+00</V>
            <V ID="82">-7.525e-01 -1.000e-02 0.000e+00</V>
            <V ID="61">-2.575e-01 1.000e-02 0.000e+00</V>
            <V ID="66">-5.050e-01 1.000e-02 0.000e+00</V>
            <V ID="71">-7.525e-01 1.000e-02 0.000e+00</V>
            <V ID="56">-1.000e-02 2.575e-01 0.000e+00</V>
            <V ID="57">-1.000e-02 5.050e-01 0.000e+00</V>
            <V ID="58">-1.000e-02 7.525e-01 0.000e+00</V>
            <V ID="75">-1.000e+00 2.575e-01 0.000e+00</V>
            <V ID="77">-1.000e+00 5.050e-01 0.000e+00</V>
            <V ID="78">-1.000e+00 7.525e-01 0.000e+00</V>
            <V ID="99">-1.000e+00 -2.575e-01 0.000e+00</V>
            <V ID="98">-1.000e+00 -5.050e-01 0.000e+00</V>
            <V ID="96">-1.000e+00 -7.525e-01 0.000e+00</V>
            <V ID="85">-2.575e-01 -1.000e+00 0.000e+00</V>
            <V ID="89">-5.050e-01 -1.000e+00 0.000e+00</V>
            <V ID="93">-7.525e-01 -1.000e+00 0.000e+00</V>
            <V ID="16">2.575e-01 -1.000e+00 0.000e+00</V>
            <V ID="21">5.050e-01 -1.000e+00 0.000e+00</V>
            <V ID="26">7.525e-01 -1.000e+00 0.000e+00</V>
            <V ID="27">1.000e+00 -2.575e-01 0.000e+00</V>
            <V ID="29">1.000e+00 -5.050e-01 0.000e+00</V>
            <V ID="30">1.000e+00 -7.525e-01 0.000e+00</V>
            <V ID="52">1.000e+00 2.575e-01 0.000e+00</V>
            <V ID="53">1.000e+00 5.050e-01 0.000e+00</V>
            <V ID="54">1.000e+00 7.525e-01 0.000e+00</V>
            <V ID="42">2.575e-01 1.000e+00 0.000e+00</V>
            <V ID="47">5.050e-01 1.000e+00 0.000e+00</V>
            <V ID="51">7.525e-01 1.000e+00 0.000e+00</V>
            <V ID="64">-2.575e-01 1.000e+00 0.000e+00</V>
            <V ID="69">-5.050e-01 1.000e+00 0.000e+00</V>
            <V ID="74">-7.525e-01 1.000e+00 0.000e+00</V>
            <V ID="12">2.575e-01 -2.575e-01 0.000e+00</V>
            <V ID="14">2.575e-01 -5.050e-01 0.000e+00</V>
            <V ID="15">2.575e-01 -7.525e-01 0.000e+00</V>
            <V ID="17">5.050e-01 -2.575e-01 0.000e+00</V>
            <V ID="19">5.050e-01 -5.050e-01 0.000e+00</V>
            <V ID="20">5.050e-01 -7.525e-01 0.000e+00</V>
            <V ID="22">7.525e-01 -2.575e-01 0.000e+00</V>
            <V ID="24">7.525e-01 -5.050e-01 0.000e+00</V>
            <V ID="25">7.525e-01 -7.525e-01 0.000e+00</V>
            <V ID="36">2.575e-01 2.575e-01 0.000e+00</V>
            <V ID="38">2.575e-01 5.050e-01 0.000e+00</V>
            <V ID="40">2.575e-01 7.525e-01 0.000e+00</V>
            <V ID="44">5.050e-01 2.575e-01 0.000e+00</V>
            <V ID="45">5.050e-01 5.050e-01 0.000e+00</V>
            <V ID="46">5.050e-01 7.525e-01 0.000e+00</V>
            <V ID="48">7.525e-01 2.575e-01 0.000e+00</V>
            <V ID="49">7.525e-01 5.050e-01 0.000e+00</V>
            <V ID="50">7.525e-01 7.525e-01 0.000e+00</V>
            <V ID="60">-2.575e-01 2.575e-01 0.000e+00</V>
            <V ID="62">-2.575e-01 5.050e-01 0.000e+00</V>
            <V ID="63">-2.575e-01 7.525e-01 0.000e+00</V>
            <V ID="65">-5.050e-01 2.575e-01 0.000e+00</V>
            <V ID="67">-5.050e-01 5.050e-01 0.000e+00</V>
            <V ID="68">-5.050e-01 7.525e-01 0.000e+00</V>
            <V ID="70">-7.525e-01 2.575e-01 0.000e+00</V>
            <V ID="72">-7.525e-01 5.050e-01 0.000e+00</V>
            <V ID="73">-7.525e-01 7.525e-01 0.000e+00</V>
            <V ID="84">-2.575e-01 -7.525e-01 0.000e+00</V>
            <V ID="86">-2.575e-01 -5.050e-01 0.000e+00</V>
            <V ID="87">-2.575e-01 -2.575e-01 0.000e+00</V>
            <V ID="88">-5.050e-01 -7.525e-01 0.000e+00</V>
            <V ID="90">-5.050e-01 -5.050e-01 0.000e+00</V>
            <V ID="91">-5.050e-01 -2.575e-01 0.000e+00</V>
            <V ID="92">-7.525e-01 -7.525e-01 0.000e+00</V>
            <V ID="94">-7.525e-01 -5.050e-01 0.000e+00</V>
            <V ID="95">-7.525e-01 -2.575e-01 0.000e+00</V>
        </VERTEX>
        <EDGE>
            <E ID="68">   41  39   </E>
            <E ID="5">    4  5   </E>
            <E ID="0">    0  1   </E>
            <E ID="110">   63  62   </E>
            <E ID="43">   22  27   </E>
            <E ID="59">   35  34   </E>
            <E ID="3">    3  0   </E>
            <E ID="54">   18  33   </E>
            <E ID="7">    4  6   </E>
            <E ID="177">   95  99   </E>
            <E ID="38">   24  22   </E>
            <E ID="103">   59  58   </E>
            <E ID="94">   54  55   </E>
            <E ID="124">   71  66   </E>
            <E ID="36">   23  18   </E>
            <E ID="35">   22  23   </E>
            <E ID="93">   54  50   </E>
            <E ID="85">   50  46   </E>
            <E ID="75">   45  38   </E>
            <E ID="131">   70  75   </E>
            <E ID="79">   47  42   </E>
            <E ID="78">   46  47   </E>
            <E ID="109">   58  63   </E>
            <E ID="126">   72  70   </E>
            <E ID="66">   38  40   </E>
            <E ID="116">   62  67   </E>
            <E ID="123">   70  71   </E>
            <E ID="64">   38  39   </E>
            <E ID="160">   90  88   </E>
            <E ID="157">   88  89   </E>
            <E ID="128">   73  72   </E>
            <E ID="168">   94  92   </E>
            <E ID="164">   88  92   </E>
            <E ID="51">   31  30   </E>
            <E ID="86">   50  51   </E>
            <E ID="172">   92  96   </E>
            <E ID="146">   76  83   </E>
            <E ID="143">   81  80   </E>
            <E ID="134">   72  77   </E>
            <E ID="165">   92  93   </E>
            <E ID="50">   26  31   </E>
            <E ID="156">   84  88   </E>
            <E ID="155">   80  87   </E>
            <E ID="149">   84  85   </E>
            <E ID="152">   86  84   </E>
            <E ID="24">   16  15   </E>
            <E ID="140">   61  80   </E>
            <E ID="12">    9  7   </E>
            <E ID="30">   15  20   </E>
            <E ID="153">    4  87   </E>
            <E ID="19">    7  14   </E>
            <E ID="72">   33  44   </E>
            <E ID="150">   85  10   </E>
            <E ID="16">    5  12   </E>
            <E ID="23">   11  16   </E>
            <E ID="117">   67  65   </E>
            <E ID="176">   98  96   </E>
            <E ID="9">    7  5   </E>
            <E ID="65">   39  37   </E>
            <E ID="173">   96  97   </E>
            <E ID="1">    1  2   </E>
            <E ID="107">   57  62   </E>
            <E ID="114">   65  66   </E>
            <E ID="57">   34  33   </E>
            <E ID="70">   42  43   </E>
            <E ID="41">   21  26   </E>
            <E ID="91">   53  49   </E>
            <E ID="122">   65  70   </E>
            <E ID="34">   17  22   </E>
            <E ID="129">   69  74   </E>
            <E ID="92">   53  54   </E>
            <E ID="52">   13  32   </E>
            <E ID="83">   49  45   </E>
            <E ID="130">   74  73   </E>
            <E ID="76">   45  46   </E>
            <E ID="100">   41  58   </E>
            <E ID="42">   26  25   </E>
            <E ID="166">   93  89   </E>
            <E ID="136">   73  78   </E>
            <E ID="115">   66  61   </E>
            <E ID="84">   49  50   </E>
            <E ID="48">   25  30   </E>
            <E ID="174">   97  93   </E>
            <E ID="145">   82  81   </E>
            <E ID="49">   30  29   </E>
            <E ID="137">   78  77   </E>
            <E ID="101">   58  57   </E>
            <E ID="158">   89  85   </E>
            <E ID="62">   37  0   </E>
            <E ID="163">   81  91   </E>
            <E ID="53">   32  0   </E>
            <E ID="96">   37  56   </E>
            <E ID="14">   10  11   </E>
            <E ID="28">   14  19   </E>
            <E ID="73">   44  36   </E>
            <E ID="127">   68  73   </E>
            <E ID="22">   15  14   </E>
            <E ID="58">   28  35   </E>
            <E ID="10">    6  8   </E>
            <E ID="4">    2  4   </E>
            <E ID="121">   69  68   </E>
            <E ID="61">   36  37   </E>
            <E ID="55">   33  32   </E>
            <E ID="8">    6  7   </E>
            <E ID="2">    2  3   </E>
            <E ID="104">   56  60   </E>
            <E ID="60">   32  36   </E>
            <E ID="63">   36  38   </E>
            <E ID="71">   43  41   </E>
            <E ID="108">   62  60   </E>
            <E ID="120">   64  69   </E>
            <E ID="39">   20  25   </E>
            <E ID="32">   16  21   </E>
            <E ID="113">   60  65   </E>
            <E ID="33">   21  20   </E>
            <E ID="90">   52  53   </E>
            <E ID="105">   60  61   </E>
            <E ID="106">   61  1   </E>
            <E ID="81">   48  44   </E>
            <E ID="167">   90  94   </E>
            <E ID="40">   25  24   </E>
            <E ID="82">   48  49   </E>
            <E ID="89">   52  48   </E>
            <E ID="162">   91  90   </E>
            <E ID="147">   83  82   </E>
            <E ID="170">   95  94   </E>
            <E ID="46">   24  29   </E>
            <E ID="97">   56  1   </E>
            <E ID="138">   74  79   </E>
            <E ID="139">   79  78   </E>
            <E ID="171">   82  95   </E>
            <E ID="99">   57  56   </E>
            <E ID="159">   86  90   </E>
            <E ID="154">   87  86   </E>
            <E ID="29">   19  17   </E>
            <E ID="26">   17  18   </E>
            <E ID="15">   11  9   </E>
            <E ID="21">    9  15   </E>
            <E ID="27">   18  13   </E>
            <E ID="148">    8  84   </E>
            <E ID="18">   13  3   </E>
            <E ID="141">   80  2   </E>
            <E ID="125">   67  72   </E>
            <E ID="151">    6  86   </E>
            <E ID="69">   40  42   </E>
            <E ID="74">   44  45   </E>
            <E ID="67">   40  41   </E>
            <E ID="119">   68  67   </E>
            <E ID="175">   94  98   </E>
            <E ID="6">    5  3   </E>
            <E ID="178">   99  98   </E>
            <E ID="118">   63  68   </E>
            <E ID="77">   46  40   </E>
            <E ID="111">   59  64   </E>
            <E ID="37">   19  24   </E>
            <E ID="31">   20  19   </E>
            <E ID="95">   55  51   </E>
            <E ID="132">   75  76   </E>
            <E ID="135">   77  75   </E>
            <E ID="112">   64  63   </E>
            <E ID="102">   43  59   </E>
            <E ID="98">   39  57   </E>
            <E ID="169">   91  95   </E>
            <E ID="161">   87  91   </E>
            <E ID="133">   76  71   </E>
            <E ID="87">   51  47   </E>
            <E ID="45">   28  23   </E>
            <E ID="144">   71  82   </E>
            <E ID="44">   27  28   </E>
            <E ID="56">   23  34   </E>
            <E ID="47">   29  27   </E>
            <E ID="179">   83  99   </E>
            <E ID="13">    8  10   </E>
            <E ID="17">   12  13   </E>
            <E ID="11">    8  9   </E>
            <E ID="88">   35  52   </E>
            <E ID="142">   66  81   </E>
            <E ID="20">   14  12   </E>
            <E ID="25">   12  17   </E>
            <E ID="80">   34  48   </E>
        </EDGE>
        <ELEMENT>
            <Q ID="0">    0     1     2     3 </Q>
            <Q ID="1">    4     5     6     2 </Q>
            <Q ID="2">    7     8     9     5 </Q>
            <Q ID="3">   10    11    12     8 </Q>
            <Q ID="4">   13    14    15    11 </Q>
            <Q ID="5">    6    16    17    18 </Q>
            <Q ID="6">    9    19    20    16 </Q>
            <Q ID="7">   12    21    22    19 </Q>
            <Q ID="8">   15    23    24    21 </Q>
            <Q ID="9">   17    25    26    27 </Q>
            <Q ID="10">   20    28    29    25 </Q>
            <Q ID="11">   22    30    31    28 </Q>
            <Q ID="12">   24    32    33    30 </Q>
            <Q ID="13">   26    34    35    36 </Q>
            <Q ID="14">   29    37    38    34 </Q>
            <Q ID="15">   31    39    40    37 </Q>
            <Q ID="16">   33    41    42    39 </Q>
            <Q ID="17">   35    43    44    45 </Q>
            <Q ID="18">   38    46    47    43 </Q>
            <Q ID="19">   40    48    49    46 </Q>
            <Q ID="20">   42    50    51    48 </Q>
            <Q ID="21">   18    52    53     3 </Q>
            <Q ID="22">   27    54    55    52 </Q>
            <Q ID="23">   36    56    57    54 </Q>
            <Q ID="24">   45    58    59    56 </Q>
            <Q ID="25">   53    60    61    62 </Q>
            <Q ID="26">   61    63    64    65 </Q>
            <Q ID="27">   64    66    67    68 </Q>
            <Q ID="28">   67    69    70    71 </Q>
            <Q ID="29">   55    72    73    60 </Q>
            <Q ID="30">   73    74    75    63 </Q>
            <Q ID="31">   75    76    77    66 </Q>
            <Q ID="32">   77    78    79    69 </Q>
            <Q ID="33">   57    80    81    72 </Q>
            <Q ID="34">   81    82    83    74 </Q>
            <Q ID="35">   83    84    85    76 </Q>
            <Q ID="36">   85    86    87    78 </Q>
            <Q ID="37">   59    88    89    80 </Q>
            <Q ID="38">   89    90    91    82 </Q>
            <Q ID="39">   91    92    93    84 </Q>
            <Q ID="40">   93    94    95    86 </Q>
            <Q ID="41">   62    96    97     0 </Q>
            <Q ID="42">   65    98    99    96 </Q>
            <Q ID="43">   68   100   101    98 </Q>
            <Q ID="44">   71   102   103   100 </Q>
            <Q ID="45">   97   104   105   106 </Q>
            <Q ID="46">   99   107   108   104 </Q>
            <Q ID="47">  101   109   110   107 </Q>
            <Q ID="48">  103   111   112   109 </Q>
            <Q ID="49">  105   113   114   115 </Q>
            <Q ID="50">  108   116   117   113 </Q>
            <Q ID="51">  110   118   119   116 </Q>
            <Q ID="52">  112   120   121   118 </Q>
            <Q ID="53">  114   122   123   124 </Q>
            <Q ID="54">  117   125   126   122 </Q>
            <Q ID="55">  119   127   128   125 </Q>
            <Q ID="56">  121   129   130   127 </Q>
            <Q ID="57">  123   131   132   133 </Q>
            <Q ID="58">  126   134   135   131 </Q>
            <Q ID="59">  128   136   137   134 </Q>
            <Q ID="60">  130   138   139   136 </Q>
            <Q ID="61">    1   106   140   141 </Q>
            <Q ID="62">  140   115   142   143 </Q>
            <Q ID="63">  142   124   144   145 </Q>
            <Q ID="64">  144   133   146   147 </Q>
            <Q ID="65">   13   148   149   150 </Q>
            <Q ID="66">   10   151   152   148 </Q>
            <Q ID="67">    7   153   154   151 </Q>
            <Q ID="68">    4   141   155   153 </Q>
            <Q ID="69">  149   156   157   158 </Q>
            <Q ID="70">  152   159   160   156 </Q>
            <Q ID="71">  154   161   162   159 </Q>
            <Q ID="72">  155   143   163   161 </Q>
            <Q ID="73">  157   164   165   166 </Q>
            <Q ID="74">  160   167   168   164 </Q>
            <Q ID="75">  162   169   170   167 </Q>
            <Q ID="76">  163   145   171   169 </Q>
            <Q ID="77">  165   172   173   174 </Q>
            <Q ID="78">  168   175   176   172 </Q>
            <Q ID="79">  170   177   178   175 </Q>
            <Q ID="80">  171   147   179   177 </Q>
        </ELEMENT>
        
        <COMPOSITE>
            <C ID="0"> Q[0-80] </C>
            <C ID="1"> E[14,23,32,41,44,47,49-51,58,70,79,87-88,90,92,94-95,102,111,120,129,132,135,137-139,146,150,158,166,173-174,176,178-179] </C>
        </COMPOSITE>
       
         <DOMAIN> C[0] </DOMAIN>
    </GEOMETRY>
    
    <EXPANSIONS>
        <E COMPOSITE="C[0]" NUMMODES="#NUMMODES#" FIELDS="u" TYPE="MODIFIED" />
    </EXPANSIONS>
    
    <CONDITIONS>

    <PARAMETERS>
      <P> FinTime            = #FinTime#        </P>
      <P> TimeStep           = #DT#             </P>
      <P> IO_CheckSteps      = 10000000         </P>
      <P> IO_InfoSteps       = 10000000         </P>
      <P> CFL                = #CFL#            </P>
      <P> NumQuadPointsError = #NQP#            </P>
    </PARAMETERS>

    <SOLVERINFO>
      <I PROPERTY="EQTYPE" VALUE="CFLtester"/>
      <I PROPERTY="Projection" VALUE="DisContinuous"/>    
      <I PROPERTY="TimeIntegrationMethod"  VALUE="#TimeScheme#"/>
    </SOLVERINFO> 

    <VARIABLES>
      <V ID="0"> u </V> 
    </VARIABLES>

    <BOUNDARYREGIONS>
      <B ID="0"> C[1] </B>
    </BOUNDARYREGIONS>

    <BOUNDARYCONDITIONS>
      <REGION REF="0">
        <D VAR="u" USERDEFINEDTYPE="TimeDependent" VALUE="exp(-41*( (x+(0.3*cos(2*PI*t)))^2 + (y-(0.3*sin(2*PI*t)))^2 ))" />
      </REGION>
    </BOUNDARYCONDITIONS>

    <FUNCTION NAME="AdvectionVelocity">
      <E VAR="Vx" VALUE="2*PI*y"  />
      <E VAR="Vy" VALUE="-2*PI*x" />
    </FUNCTION>   
    
    <FUNCTION NAME="ExactSolution">
      <E VAR="u" VALUE="exp(-41*( (x+(0.3*cos(2*PI*t)))^2 + (y-(0.3*sin(2*PI*t)))^2 ))" />
    </FUNCTION>
    
    <FUNCTION NAME="InitialConditions">
      <E VAR="u" VALUE="exp(-41*( (x+(0.3*cos(2*PI*t)))^2 + (y-(0.3*sin(2*PI*t)))^2 ))" />
    </FUNCTION>
    
  </CONDITIONS>
  
  <GLOBALOPTIMIZATIONPARAMETERS>

        <BwdTrans>
            <DO_GLOBAL_MAT_OP VALUE="#OPT1#" />
            <DO_BLOCK_MAT_OP TRI="#OPT2#" QUAD="#OPT3#" />
        </BwdTrans>

        <IProductWRTBase>
            <DO_GLOBAL_MAT_OP VALUE="#OPT1#" />
            <DO_BLOCK_MAT_OP TRI="#OPT2#" QUAD="#OPT3#" />
        </IProductWRTBase>

        <MassMatrixOp>
            <DO_GLOBAL_MAT_OP VALUE="#OPT1#" />
            <DO_BLOCK_MAT_OP TRI="#OPT2#" QUAD="#OPT3#" />
        </MassMatrixOp>

        <HelmholtzMatrixOp>
            <DO_GLOBAL_MAT_OP VALUE="#OPT1#" />
            <DO_BLOCK_MAT_OP TRI="#OPT2#" QUAD="#OPT3#" />
        </HelmholtzMatrixOp>

  </GLOBALOPTIMIZATIONPARAMETERS>
  
</NEKTAR>
