<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<html xmlns="http://www.w3.org/1999/xhtml"><!-- InstanceBegin template="/Templates/Main.dwt" codeOutsideHTMLIsLocked="false" -->
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <link rel="shortcut icon" href="images/favicon.ico" >
    <!-- InstanceBeginEditable name="doctitle" -->
<title>Nektar++ - Usage</title>
<!-- InstanceEndEditable -->
   <link rel="stylesheet" href="style.css">
    <!-- InstanceBeginEditable name="CSS_Style" -->
<style type="text/css">
<!--
#menu_Usage {
	font-weight: bold;
}
-->
</style>
<!-- InstanceEndEditable -->
    <!--[if IE]>
    <style type="text/css"> 
      .twoColHybLt #sidebar1 { padding-top: 30px; margin-top: 20px; }
      .twoColHybLt #mainContent { zoom: 1; padding-top: 15px; }
    </style>
    <![endif]-->
    <!-- InstanceParam name="LibraryMenu" type="boolean" value="false" -->
    <!-- InstanceParam name="CompileMenu" type="boolean" value="false" -->
  </head>
  <body class="twoColHybLt">
    <div id="container">
      <div id="sidebar1">
        <h3 style="text-align: center;"><a href="index.html" id="menu_Nektar"><img src="images/nektar.png" alt="Nektar++" width="155" height="38" /></a></h3>

<p><a href="downloads.html" id="menu_Downloads">Downloads</a></p>
<p><a href="compile.html" id="menu_Compile">Compilation Instructions</a></p>
<p><a href="usage.html" id="menu_Usage">Example Usage</a></p>
<p><a href="educational_material.html" id="menu_EducationalMaterial">Educational
Material</a></p>
<p><a href="code/index.html" id="menu_Library">Documentation</a></p>
<p><a href="team.html" id="menu_Team">Team Members</a></p>
<p><a href="publications.html" id="menu_Publications">Publications</a></p>
<p><a href="license.html" id="menu_License">License</a></p>
<p><a href="acknowledgments.html" id="menu_Acknowledgments">Acknowledgments</a></p>
<p><a href="mailto:nektar-inquiry@sci.utah.edu" id="menu_Contact">Contact</a></p>


        <p style="font-size:9px;">Last Revision:<br/>$Date: 2009/05/02 16:49:13 $</p>
      </div>
      <div id="mainContent">
 <h1>Usage: Incompressible Navier-Stokes Solver</h1>
<p>
Here, we will explain how to use the incompressible Navier-Stokes solver of Nektar++. Its source code is located at <code>Nektar++/solvers/IncNavierStokesSolver</code>. <br />
We will start by demonstrating how to run a first example with the incompressible Navier-Stokes solver and briefly explain the options of the solver specified in the input file. These explanations will be based on the example file <code>QuadMesh.xml</code> that can be found in
<code>Nektar++/solvers/IncNavierStokesSolver</code>. The  <code>QuadMesh.xml</code> example file describes a channel flow in x-direction. <br />
After these introductory explanations, we will present some <a href="usage_solver_IncNavierStokes.html#otherexamples">numerical results</a> in order to demonstrate the capabilities and the accuracy of the solver.
</p>
<p>
Briefly, the Navier-Stokes solver computes the solution of the Navier-Stokes equation in two space dimensions in terms of the primitive variables velocity
 <span class="latexfontbold">v</span> <span class="latexfontitalic">=(u,v)</span> and pressure <span class="latexfontitalic">p</span> for a fluid with kinematic viscosity <img src="images/IncNavierStokesDoc8x.png" width="10" height="9" />
<center>
<p>
<img src="images/IncNavierStokesDoc0x.png" width="274" height="63" alt="Navier-Stokes Equation"/>
</p>
</center>
subject to appropriate initial and boundary conditions. For example, a typical set of boundary conditions would be given by
<center>
<p>
<img src="images/IncNavierStokesDoc1x.png" width="312" height="95" />
</p>
</center>
where <span class="latexfontbold">n</span> is the unit outward normal vector on the boundary. 
For simplicity, we assume that the density of the fluid is <span class="latexfontitalic">&rho;=1</span>. The Navier-Stokes equations describe an incompressible, isothermal flow with constant properties.
</p>
<h2>How to get started</h2>
<h3>Compiling the code</h3>
<p>
Follow the <a href="compile.html" id="menu_Compile">compile instructions</a> and build the Nektar++ library, the solvers and the utilities. 
</p>
<h3>Running a first example</h3>
<p>
The folder <code>Nektar++/solvers/IncNavierStokesSolver</code> contains several <code>*.xml</code> files. 
These are input files for the Navier-Stokes solver specifying the geometry (i.e. the mesh and 
the spectal/hp expansion), the parameters and boundary conditions. 
Further details on the structure of the input file can be found <a href="usage_solver_IncNavierStokes.html#inputfileoptions">below</a>. 
<br /> 
Now, lets try to run the <code>QuadMesh.xml</code> example that can be found in 
<code>Nektar++/solvers/IncNavierStokesSolver</code>:
<ol>
<li> Copy the input file, <code>QuadMesh.xml</code> to the directory where the solver is compiled, e.g. 
<code>Nektar++/solvers/IncNavierStokesSolver/build/IncNavierStokesSolver</code>.
</li>
<li>Run the code by typing
<div class="code"><pre>./IncNavierStokesSolver QuadMesh.xml</pre></div>
</li>
</ol>
The solution should now have been written to the file <code>QuadMesh.fld</code>. 
This file is formatted in the Nektar++ output format (see <a href="post-processing.html">here</a>).<br />
To visualise the solution, we can convert the fld-file into Vtk, Gmsh or Tecplot file formats using 
the Post-processing tools in <code>Nektar++/utilities/builds/PostProcessing/</code>. 
Here, we will demonstrate how to convert the <code>fld</code>-file into Vtk-file format. 
The <a href="http://www.vtk.org/">Visualization Toolkit (VTK)</a> is an open-source visualisation library for 3D computer graphics. 
There is a wide range of open source GUIs available for VTK, e.g. <a href="http://www.paraview.org/">paraview</a>.
We convert the <code>fld</code>-file into Vtk-file format by typing 
<div class="code"><pre>../../../utilities/builds/PostProcessing/FldToVtk QuadMesh.xml QuadMesh.fld</pre></div>
(Make sure you are still at the directory <code>Nektar++/solvers/IncNavierStokesSolver/build/IncNavierStokesSolver</code>.)
This should have been created the file <code>QuadMesh.vtu</code> in the current directory. 
The <code>*.vtu</code> files can now be opened with paraview, for example. 
<center>
<img src="images/QuadMeshu.png" width="285" height="236" />
</center>
<h2 id="inputfileoptions">Input file options</h2>
<h3>Description of the mesh</h3>
<p>
The mesh is described between the XML tags
<div class="source"><pre>
&lt;GEOMETRY&gt;
... 
&lt;/GEOMETRY&gt;
</pre></div>
which contains a list of the vertices, edges and elements. 
This mesh information can be generated using Gmsh an open-source finite element mesh generator which 
can be downloaded at <a href="http://geuz.org/gmsh/" />http://geuz.org/gmsh/</a>. 
<!--and converted to the Nektar input file format using the Pre-processing tool.
Meshconvert in <code>Nektar++/utilities/builds/PreProcessing/</code>. -->
Further details about creating a mesh can be found in the <a href="pre-processing.html">Pre-processing</a> section.
</p>
</p>
<h3>Description of the spectral/hp expansion</h3>
<p>
Between the XML tags 
<div class="source"><pre>
&lt;EXPANSIONS&gt;
...
&lt;/EXPANSIONS&gt;
</pre></div>
the spectral/hp expansion used to represent the solution is specified. For example
<div class="sourceexample"><pre>
&lt;EXPANSIONS&gt;
  &lt;E COMPOSITE="C[0]" NUMMODES="3" TYPE="MODIFIED" /&gt;
&lt;/EXPANSIONS&gt;
</pre></div>
<code class="source">NUMMODES</code> specifies the number of expansion modes and <code class="source">TYPE</code> defines the type of basis functions. <br />
<!-- For meshes consisting of quadrilateral and/or triangular elements, the most suitable expansion basis to choose, 
is the modified semi-orthogonal expansion basis, which can be chosen by setting . -->
<code class="source">TYPE="MODIFIED"</code> will choose the modified semi-orthogonal expansion basis, which was first discussed by Dubiner [2], to approximate the variables. 
Details on this expansion basis can be found in Chapter 3.2.3 in the book of Karniadakis and Sherwin [1]. 
<!-- GLL_LAGRANGE for quadrilateral meshes -->
<!-- Lets assume we are looking for the solution u(x,t) of a differential equation. Further,
it is assumed that the solution u(x,t) can be accurately represented by the approximate solution of the form 
NUMMODES= P+1 -->
<h3>Description of parameters, solver information and boundary conditions</h3>
<p>In between the XML tags 
<div class="source"><pre>
&lt;CONDITIONS&gt;
...
&lt;/CONDITIONS&gt;
</pre></div>
all the necessary information for a specific solver is given. 
</p> 
<h4>Solver information</h4>
The solver information is given in between the XML tags 
<div class="source"><pre>
<font color="gray">&lt;CONDITIONS&gt;</font>
    &lt;SOLVERINFO&gt;
    ...
    &lt;/SOLVERINFO&gt;
<font color="gray">...
&lt;/CONDITIONS&gt;</font>
</pre></div>
For the incompressible Navier-Stokes solver, we specify for example 
<div class="sourceexample"><pre>
&lt;SOLVERINFO&gt;      
      &lt;I PROPERTY="EQTYPE" VALUE="UnsteadyNavierStokes"/&gt;
      &lt;I PROPERTY="AdvectionForm" VALUE="Convective"/&gt;
      &lt;I PROPERTY="TimeIntegrationMethod" VALUE="IMEXOrder2"/&gt;
&lt;/SOLVERINFO&gt;
</pre></div>
Here, <code class="source">EQTYPE</code> specifies the equation to be solved. We set it to the <code class="source">VALUE="UnsteadyNavierStokes"</code>, i.e. we want to solve the equation 
<center>
<p>
<img src="images/IncNavierStokesDoc2x.png" width="274" height="63" alt="Navier-Stokes Equation"/>
</p>
</center>
<!-- Options are UnsteadyStokes and UnsteadyNavierStokes. -->
Furthermore, we set the <code class="source">AdvectionForm</code> to <code class="source">Convective</code>, i.e. we compute the advection term as 
<img src="images/IncNavierStokesDoc3x.png" width="71" height="15" />.
<!-- The advection form is only needed in case of the UnsteadyNavierStokes equation. 
for the advection term Convective or NonConservative -->
<br>
<!-- The <code class="source">TimeIntegrationMethod</code> specifies the scheme used to solve the Navier-Stokes equations in time. -->
The incompressible Navier-Stokes equations are solved in time using a <strong>velocity correction splitting scheme</strong> combined 
with <strong>stiffly-stable time integration</strong> which is derived from the work of Karniadakis, Israeli and Orszag [3]. Briefly, the time integration scheme consists of the following steps: 
<ol>
   <li>
Calculate a first intermediate velocity field by 
 calculating the advection term explicitly and combining it with the solution at previous time-steps
<center>
<p> 
<img src="images/IncNavierStokesDoc9x.png" width="363" height="63" /> 
</p>
</center>
</li>
   <li> Solve a Poisson equation to obtain the pressure solution at the new time level
<center>
<p> 
<img src="images/IncNavierStokesDoc10x.png" width="165" height="36" /> 
</p>
</center> 
with consistent boundary conditions
<center>
<p> 
<img src="images/IncNavierStokesDoc11x.png" width="537" height="62" /> 
</p>
</center> 
</li>
   <li>  Calculate a second intermediate velocity field 
<center>
<p> 
<img src="images/IncNavierStokesDoc12x.png" width="159" height="46" />
</p>
</center> 
</li>
 <li> Use the second intermediate velocity field as a forcing term in a Helmholtz problem to obtain the velocity field at the new time level
<center>
<p> 
<img src="images/IncNavierStokesDoc13x.png" width="230" height="36" />
</p>
</center>
</li>
 </ol>
Here, <span class="latexfontitalic">J</span> is the integration order and <span class="latexfont">&gamma;&#8320;</span>, <span class="latexfont">&alpha;<sub>q</sub></span> and <span class="latexfont">&beta;<sub>q</sub></span> are the stiffly stable time integration coefficients given in the table below. 
<p>
<center>
<table class="border" rules="rows" frame="border" >
  <caption class="border">Table: Stiffly stable splitting scheme coefficients </caption>
  <colgroup>
    <col width="10%" />
    <col width="30%" />
    <col width="30%" />
    <col width="30%" />
  </colgroup>
  <thead>
    <tr>
      <th class="border"></th>
      <th>1st order </th>
      <th>2nd order</th>
      <th>3rd order</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="border"><span class="latexfont">&gamma;&#8320;</span></td>
      <td>1</td>
      <td>3/2</td>
      <td>11/6</td>
    </tr>
    <tr>
      <td class="border"><span class="latexfont">&alpha;&#8320;</span></td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td class="border"><span class="latexfont">&alpha;&#8321;</span></td>
      <td>0</td>
      <td>-1/2</td>
      <td>-3/2</td>
    </tr>
    <tr>
      <td class="border"><span class="latexfont">&alpha;&#8322;</span></td>
      <td>0</td>
      <td>0</td>
      <td>1/3</td>
    </tr>
    <tr>
      <td class="border"><span class="latexfont">&beta;&#8320;</span></td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td class="border"><span class="latexfont">&beta;&#8321;</span></td>
      <td>0</td>
      <td>-1</td>
      <td>-3</td>
    </tr>
    <tr>
      <td class="border"><span class="latexfont">&beta;&#8322;</span></td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</center>
</p>
This multi-step implicit-explicit splitting scheme decouples the velocity field <span class="latexfontbold">v</span> from the pressure <span class="latexfontitalic">p</span>, leading to an
explicit treatment of the advection term and an implicit treatment of the pressure and the diffusion term.
For details on the velocity correction scheme and the stiffly stable time integrators see Chapter 8.3.2.5 and 8.3.2.6 in the book of Karniadakis and Sherwin [1]. 
We can choose between the first-order, the second-order or the third-order scheme by setting <code class="source">TimeIntegrationMethod</code> to <code class="source">
IMEXOrder1,
IMEXOrder2</code> or
<code class="source">
IMEXOrder3</code>.
</p>
<!-- <h5>Implementation Details</h5>
To perform the various steps of the scheme, the following two functions have been implemented:
<ol>
<li> One for for the explicit term. This function evaluates the advection
term, i.e.

Because we follow a pseudo-spectral approach for the advection term, this
term is simply evaluated at the quadrature/collocation points.
</li>
<li> 
For the implicit part of the scheme, a routine that solves the following problem
is required. Given an arbitrary function f, a scalar  and a time-level t, find the
velocity field V such that
∇2p =∇ · (
f

); (4.6a)
V − ∇2V =f − ∇p; (4.6b)
and subject to the appropriate boundary conditions. It can be observed that this
problem involves the consecutive solution of three elliptic problems: a Poisson
problem and two (in 2D) scalar Helmholtz problems.
</li>
</ol> -->
</p>
<h4>Parameters</h4>
<p>
Between the XML tags 
<div class="source"><pre>
<font color="gray">&lt;CONDITIONS&gt;</font>
    &lt;PARAMETERS&gt;
    ...
    &lt;/PARAMETERS&gt;
<font color="gray">...
&lt;/CONDITIONS&gt;</font>
</pre></div>
the parameters of the equation and the time integration scheme as well as output options are specified.
For example
<div class="sourceexample"><pre>&lt;PARAMETERS&gt;
   &lt;P&gt; TimeStep      = 0.001 &lt;/P&gt;
   &lt;P&gt; NumSteps      = 100   &lt;/P&gt;
   &lt;P&gt; IO_CheckSteps = 10    &lt;/P&gt;
   &lt;P&gt; IO_InfoSteps  = 10    &lt;/P&gt;
   &lt;P&gt; Kinvis        = 1.0   &lt;/P&gt;
&lt;/PARAMETERS&gt;
</pre></div>
The only material property we have to specify for the incompressible Navier-Stokes equation is the kinematic viscosity, which is set by assigning a floating point number to <code class="source">Kinvis</code>. <br /> 
The parameter <code class="source">TimeStep</code> defines <span class="latexfont">&Delta;t</span> in the time integration scheme and <code class="source">NumSteps</code> is the total number of steps the time integration 
scheme will perform. That means the physical endtime will be <code>TimeStep*NumSteps</code>. <br />
<code class="source">IO_CheckSteps</code> specifies the number of time steps that will be performed between writing the solution to output files. These output files are named <code>&lt;INPUTFILENAME&gt;_&lt;NUMBER&gt;.chk</code>. They can be converted into Vtk, Tecplot or Gmsh file formats using the same Post-Processing tools as for the <code>fld</code>-files. The conversion tools can be found in <code>Nektar++/utilities/builds/PostProcessing/</code>.<br />
<code class="source">IO_InfoSteps</code> specifies the number of time steps between displaying information on the console.
</p>
<h4>Boundary and initial conditions</h4> 
Before any other conditions for the solver can be set, we need to specify the variables used in the Navier-Stokes solver by 
including the lines
<div class="sourceexample"><pre>
&lt;VARIABLES&gt;
  &lt;V ID="0"&gt; u &lt;/V&gt; 
  &lt;V ID="1"&gt; v &lt;/V&gt; 
  &lt;V ID="2"&gt; p &lt;/V&gt; 
&lt;/VARIABLES&gt;
</pre></div>
<p>
To specify boundary conditions, we first need to identify the different boundary regions defining one region for each boundary type, e.g. one for the inflow boundary, one for walls and one for the outflow boundary with
<div class="sourceexample"><pre>
&lt;BOUNDARYREGIONS&gt;
  &lt;B ID="0"&gt; C[1] &lt;/B&gt;
  &lt;B ID="1"&gt; C[2] &lt;/B&gt;
  &lt;B ID="2"&gt; C[3] &lt;/B&gt;
&lt;/BOUNDARYREGIONS&gt; 
</pre></div>
where <code class="source">C[X]</code> are the composites, which consist of a number of edges, defined in the 
<code class="source">&lt;GEOMETRY&gt; ... &lt;/GEOMETRY&gt;</code> section of the input file.<br />
Now, we can specify the boundary conditions between the XML tags 
<div class="source"><pre>
<font color="gray">&lt;CONDITIONS&gt;</font>
    &lt;BOUNDARYCONDITIONS&gt;
    ...
    &lt;/BOUNDARYCONDITIONS&gt;
<font color="gray">...
&lt;/CONDITIONS&gt;</font>
</pre></div>
For example
 <div class="sourceexample"><pre>&lt;BOUNDARYCONDITIONS&gt;
  &lt;REGION REF="0"&gt;
    &lt;D VAR="u" VALUE="0" /&gt;
    &lt;D VAR="v" VALUE="0" /&gt;
    &lt;N VAR="p" USERDEFINEDTYPE="H" VALUE="0"/&gt;  
  &lt;/REGION&gt;
  &lt;REGION REF="1"&gt;
    &lt;D VAR="u" VALUE="y*(1-y)" /&gt;
    &lt;D VAR="v" VALUE="0" /&gt;
    &lt;N VAR="p" USERDEFINEDTYPE="H" VALUE="0"/&gt;  
  &lt;/REGION&gt;
  &lt;REGION REF="2"&gt;
    &lt;N VAR="u" VALUE="0" /&gt;
    &lt;N VAR="v" VALUE="0" /&gt;
    &lt;D VAR="p" VALUE="0" /&gt;
  &lt;/REGION>&gt;
&lt;/BOUNDARYCONDITIONS&gt;
</pre></div>
In this example, Region 0 shows typical boundary conditions for walls, Region 1 for inlet boundaries and Region 2 for outlet boundaries. <br />
The XML tags <code class="source">D</code> and <code class="source">N</code>  identify the boundary condition to be of <strong>Dirichlet</strong> or <strong>Neumann</strong> type, respectively. 
For example, <code class="source">D VAR="u" VALUE="0"</code> means set <span class="latexfontitalic">u=0</span> and <code class="source">N VAR="u" VALUE="0"</code> means set <img src="images/IncNavierStokesDoc7x.png" width="92" height="21" />.<br />
Furthermore, the boundary condition  <code class="source">D VAR="u" VALUE="y*(1-y)"</code> sets a parabolic inflow profile and <code class="source">N VAR="p" USERDEFINEDTYPE="H" VALUE="0"</code> specifies high-order boundary conditions for the pressure of the form 
<center>
<p>
<img src="images/IncNavierStokesDoc5x.png" width="537" height="62" />
</p>
</center>
where <span class="latexfontitalic">J</span> is the integration order, <span class="latexfont">&beta;<sub>q</sub></span> are the stiffly stable time integration coefficients given in the table above and <span class="latexfontbold">n</span> is the unit outward normal vector on the boundary.
<p>
<p>
Additionally, <strong>time-dependent</strong> boundary conditions can be specified in the input file by setting <code class="source">USERDEFINEDTYPE="TimeDependent"</code> in the boundary region. For example, see the  <code>Test_DecVortex_m3.xml</code> file in the folder  <code>Nektar++/regressionTests/Solvers/IncNavierStokesSolver/InputFiles/</code> describing a <a href="usage_solver_IncNavierStokes.html#taylordecv">Taylor Decaying Vortex.</a> The time-dependent dirichlet boundary conditions in this example are specified as follows
 <div class="sourceexample"><pre>&lt;BOUNDARYCONDITIONS&gt;
...
  &lt;REGION REF="1"&gt;
    &lt;D VAR="u" USERDEFINEDTYPE="TimeDependent" VALUE="-cos(x)*sin(y)*exp(-2*t*Kinvis)"/&gt;
    &lt;D VAR="v" USERDEFINEDTYPE="TimeDependent" VALUE="sin(x)*cos(y)*exp(-2*t*Kinvis)"/&gt;
    &lt;D VAR="p" USERDEFINEDTYPE="TimeDependent" VALUE="-0.25*(cos(2*x)+cos(2*y))*exp(-4*t*Kinvis)"/&gt; 
  &lt;/REGION&gt;
&lt;/BOUNDARYCONDITIONS&gt;
</pre></div>
</p>
<p>
The initial conditions are defined between the XML tags 
<div class="source"><pre>
<font color="gray">&lt;CONDITIONS&gt;</font>
    &lt;INITIALCONDITIONS&gt;
    ...
    &lt;/INITIALCONDITIONS&gt;
<font color="gray">...
&lt;/CONDITIONS&gt;</font>
</pre></div>
For example for Poiseuille flow 
<div class="sourceexample"><pre>
&lt;INITIALCONDITIONS&gt;
    &lt;F VAR="u" VALUE="y*(1-y)" /&gt;
    &lt;F VAR="v" VALUE="0" /&gt;
    &lt;F VAR="p" VALUE="0" /&gt;
&lt;/INITIALCONDITIONS&gt;
</pre></div>
This initialises <span class="latexfontitalic">u</span> with a parabolic profile and <span class="latexfontitalic">v</span> and <span class="latexfontitalic">p</span> with zero in the whole domain. </p>
<p>
To compare the numerical solution with an analytical solution, the analytical solution can be specified in between the XML tags
<div class="source"><pre>
<font color="gray">&lt;CONDITIONS&gt;</font>
    &lt;EXACTSOLUTION&gt;
    ...
    &lt;/EXACTSOLUTION&gt;
<font color="gray">...
&lt;/CONDITIONS&gt;</font>
</pre></div>
For example for Poiseuille flow in a channel with length 1 
<div class="sourceexample"><pre>
&lt;EXACTSOLUTION&gt;
    &lt;F VAR="u" VALUE="y*(1-y)" /&gt;
    &lt;F VAR="v" VALUE="0" /&gt;
    &lt;F VAR="p" VALUE="-2*Kinvis*(x-1)" /&gt;
&lt;/EXACTSOLUTION&gt;
</pre></div>
The solver will evaluate the L2-Error between the solution and the given exact solution at the end of the computation. 
</p>
<p>
<h2 id="otherexamples">Numerical results</h2>
<!--<h3>Steady test cases</h3>
 First, we will present numerical results for very well-known steady problems:
a 2D Channel Flow and a more complex flow problem, the Kovasznay Flow. These two examples have been used as control cases for the Incompressible Navier Stokes solver and regressions tests have been set inside the \emph{Nektar++} framework to permit the user a fast check of the algorithm reliability during the development process. -->
<!-- TODO: explanation on how to use these regressions tests -->
<!-- <h4>Channel Flow</h4>
The figure below displays the x-component of the velocity field <span class="latexfontitalic">u</span> for the two dimenstional channel flow which shows a typical parabolic profile. The mesh consists of 4 quadrilaterals which span the rectangular domain  $\boldsymbol{x} \in [0\,,1] \times [0\,,1]$. The parabolic profile has been set as the inflow condition for the x-component of the velocity ($u=y(1-y)$). The convergence has been checked for various expansion orders ($2 \leq P \leq 10$) obtaining an error close to the machine precision ($10^{-16}$) for $P \geq 3$. -->
<h3>Kovasznay Flow</h3>
<center>
<p> 
<table class="image">
<tr><td><img src="images/kov.png" width="400" height="443" />
<tr><td class="caption">Streamlines of the 2D solution for a Kovasznay flow computed with the Navier-Stokes solver.</td></tr>
</table>
</p>
</center>
<p>
To investigate the convergence rate of the Navier-Stokes solver, we compare the computed solution with the analytical solution for a Kovasznay flow. The input file <code>Test_KovFlow.xml</code> for this flow configuration can be found at <code>Nektar++/solvers/IncNavierStokesSolver/build/IncNavierStokesSolver</code>.<br />
In 1948, Kovasznay solved the problem of steady, laminar flow behind a two-dimensional grid. The exact solution to the Navier-Stokes equations is given by:
<center>
<p> 
<img src="images/IncNavierStokesDoc15x.png" width="162" height="21" />
</p>
</center>
<center>
<p> 
<img src="images/IncNavierStokesDoc16x.png" width="150" height="42" />
</p>
</center>
<center>
<p> 
<img src="images/IncNavierStokesDoc21x.png" width="132" height="41" />
</p>
</center>
</p>
<center>
<p> 
<img src="images/IncNavierStokesDoc18x.png" width="190" height="42" />
</p>
</center>
</p>
The figure above shows the streamlines of the 2D solution obtained with the Navier-Stokes solver.
A 12 quadrilaterals mesh has been used in a rectangular domain defined as 
<img src="images/IncNavierStokesDoc23x.png" width="217" height="20" />.
The solution looks similar to the low-speed flow of a viscous fluid 
past an array of cylinders. The Reynolds number has been set to <img src="images/IncNavierStokesDoc24x.png" width="127" height="21" />. 
The analytical solution for the velocity and the pressure have been used to set Dirichlet boundary conditions. Knowing the exact solution, we can calculate the convergence rate with respect to the expansion order. We observe exponential convergence of the error up to error values of <img src="images/IncNavierStokesDoc25x.png" width="44" height="18" />.
<center>
<p> 
<table class="image">
<tr><td><img src="images/kov_dt0001.png" width="466" height="351" /></td></tr>
<tr><td class="caption">Convergence rate in the L2-norm.</td></tr>
</table>
</p>
</center>
<h3 id="taylordecv">Taylor Decaying Vortex</h3>
<center>
<p> 
<img src="images/DecVort_u.png" width="234" height="201" />
<img src="images/DecVort_v.png" width="234" height="201" />
<img src="images/DecVort_w.png" width="234" height="201" />
</p>
</center>
<p>
To evaluate the time accuracy of the Navier-Stokes solver, we compute a Taylor decaying vortex described by the equations 
<center>
<p> 
<img src="images/IncNavierStokesDoc28x.png" width="219" height="25" /> 
</p>
</center>
<center>
<p> 
<img src="images/IncNavierStokesDoc29x.png" width="199" height="24" /> 
</p>
</center>
<center>
<p> 
<img src="images/IncNavierStokesDoc30x.png" width="294" height="42" />
</p>
</center>
in a square domain <img src="images/IncNavierStokesDoc26x.png" width="231" height="41" />. <br />
The figures above show the numerical results for the  velocity components and the vorticity using a 16 quadrilaterals mesh, an expansion order of <span class="latexfontitalic">P=11</span> and the third order time-integration scheme. The exact solution has been used to set Dirichlet boundary conditions on the edges. Using a time-step 
<img src="images/IncNavierStokesDoc27x.png" width="94" height="15" />
the L2-error obtained is 10<sup>-13</sup> for the velocity field and 10<sup>-12</sup> for the pressure. 
</p>
<h3>Flow Past a Cylinder</h3>
<center>
<p> 
<img src="images/vxshed.png" width="619" height="364" />
</p>
</center>
</p>
<p>
As an illustrative example to demonstrate the capability of the solver to solve more complex fluid dynamics problems, we compute the two-dimensional flow past a circular cylinder in a free stream. The figure above shows the vorticity field of a flow past a cylinder with a Reynolds number <span class="latexfontitalic">Re=100</span> using the third order time integration scheme. Now, consider the following configuration. 
<center>
<p> 
<img src="images/sphereschematics.png" width="585" height="194" />
</p>
</center>
Consider an infinitely long cylinder of diameter <span class="latexfontitalic">D</span> placed midway between two parallel plates 
which are a distance <span class="latexfontitalic">H</span> apart, as shown in the figure above.
A no-slip condition is imposed on the plates and the cylinder boundary, 
a parabolic inflow profile is specified as the inflow condition with a maximum inlet speed of <span class="latexfontitalic">U<sub>max</sub>=1</span> and 
at the outflow boundary homogeneous Neumann boundary conditions are imposed.  
The Reynolds number for the flow around a cylinder is defined by
<img src="images/IncNavierStokesDoc31x.png" width="129" height="21" />,  where <img src="images/IncNavierStokesDoc8x.png" width="10" height="9" /> is the kinematic viscosity. The figures below show the mesh configuration and contour plots of the computed velocity components for a Reynolds number of 100 for a  
mesh consisting of 856 quadrilateral elements and a polynomial order P=4 after a physical time of 150s. 
<table>
<p> 
<img src="images/vortexsheddingnewmesh.png" width="705" height="204" />
<table class="image">
<tr><td><img src="images/vortexsheddingnewvelu.png" width="585" height="87" /></td></tr>
<tr><td class="caption">Velocity component <span class="latexfontitalic">u</span>.</td></tr>
</table>
<table class="image">
<tr><td><img src="images/vortexsheddingnewvelv.png" width="586" height="88" /></td></tr>
<tr><td class="caption">Velocity component <span class="latexfontitalic">v</span>.</td></tr>
</table>
</p>
</center>
We chose a kinematic viscosity of 0.01 and the first order time integration scheme with a timestep of 0.001. We can observe vortices that are shedding periodically from the cylinder. The vortex shedding behaviour can be observed nicely in the following two videos. <br />
The first video shows the evolution of the velocity component <span class="latexfontitalic">u</span> and <span class="latexfontitalic">v</span> and the velocity vector length. <br />
The second video shows a comparison of the vortex shedding behaviour for different Reynolds number. For a Reynolds number of 50 no vortex shedding is observed. The vortex shedding frequency increases with increasing Reynolds number. Click on the pictures or the links above the pictures to see the videos. <p>
<a href="videos/vortexstreetuv.avi">
Video of contour plots for the velocity component <span class="latexfontitalic">u</span> and <span class="latexfontitalic">v</span> and the velocity vector length:
</a>
<center>
<p>
<a href="videos/vortexstreetuv.avi">
<img src="images/vortexre100.png" width="540" height="266" />
</a>
</p>
</center>
<a href="videos/vortexstreetdifferentre.avi">Video of contour plots for the velocity component <span class="latexfontitalic">u</span> for a range of Reynolds numbers:</a>
<center>
<p>
<a href="videos/vortexstreetdifferentre.avi">
<img src="images/VortexStreetRe.png" width="540" height="266"/>
</a>
</p>
</center>
</p>
</center>
</p>
<p>
That concludes the brief introduction into the incompressible Navier-Stokes solver.
Further details can be found in the doxygen documentation of Nektar++ (see <a href="compile_documentation.html">documentation compile instructions</a>) and in the book of Karniadakis and Sherwin [1].
</p>

[1] G.E. Karniadakis and S.J. Sherwin: <i>Spectral/hp Element Methods for Computational Fluid Dynamics</i>, Oxford Science Publications, 2005<br />
[2] M. Dubiner: <i>Spectral methods on triangles and other domains</i>, J. Sci. Comp., 6, 345-390, 1991 <br />
[3] G. E. Karniadakis, M. Israeli, and S. A. Orszag: <i>High-order splitting methodsfor the incompressible Navier-Stokes equations</i>, J. Comput. Phys., 97, 414-443, 1991.

</p>
    </div>


  </body>
<!-- InstanceEnd --></html>